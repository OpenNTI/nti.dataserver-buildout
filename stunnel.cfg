[buildout]
extends =
		deployment.cfg
		openssl.cfg

parts +=
	  directories
      zlib
	  openssl
	  stunnel

[stunnel]
recipe = hexagonit.recipe.cmmi
url = https://www.stunnel.org/downloads/stunnel-5.14.tar.gz
md5sum = e716501960dc6856d80f92547298f724
keep-compile-dir = true
ldflags = "-L${zlib:location}/lib -L${openssl:location}/lib -Wl,-rpath ${openssl:location}/lib -Wl,-rpath ${zlib:location}/lib"
configure-options =
				  --bindir=${deployment:bin-directory}
				  --sbindir=${deployment:bin-directory}
				  --sysconfdir=${deployment:etc-directory}
				  --localstatedir=${deployment:run-directory}
				  --with-ssl=${openssl:location}
				  --disable-fips
				  --disable-dependency-tracking
				  LDFLAGS=${:ldflags}
				  CFLAGS=-I${zlib:location}/include

[stunnel:linux]
ldflags = "-L${zlib:location}/lib -L${openssl:location}/lib -Wl,-rpath=${openssl:location}/lib -Wl,-rpath=${zlib:location}/lib"
