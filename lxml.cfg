[buildout]
extends =
	liblzma.cfg
	zlib.cfg

parts =
	liblzma
	zlib
	libxml2
	libxslt
	lxml

[libxml2]
recipe = hexagonit.recipe.cmmi
url = https://downloads.nextthought.com/deps/libxml2-2.9.4.tar.gz
keep-compile-dir = true
configure-options =
	--without-python
	--with-zlib=${zlib:location}
	--with-lzma=${liblzma:prefix}
environment =
	CFLAGS=-I${liblzma:prefix}/include
	LDFLAGS=-L${liblzma:prefix}/lib -Wl,-rpath -Wl,${liblzma:prefix}/lib -Wl,-rpath -Wl,${zlib:prefix}/lib

[libxslt]
recipe = hexagonit.recipe.cmmi
url = https://downloads.nextthought.com/deps/libxslt-1.1.29.tar.gz
keep-compile-dir = true
configure-options =
	--without-python
	--without-crypto
	--with-libxml-prefix=${libxml2:location}

[lxml]
recipe = zc.recipe.egg:custom
force = true
egg = lxml==3.6.0
environment = lxml_environment
include-dirs =
	${libxml2:prefix}/include
	${libxslt:prefix}/include
	${zlib:prefix}/include
library-dirs =
	${libxml2:prefix}/lib
	${libxslt:prefix}/lib
	${zlib:prefix}/lib
rpath = ${:library-dirs}

[lxml_environment]
CFLAGS = -O3
XML_CONFIG = ${libxml2:prefix}/bin/xml2-config
XSLT_CONFIG = ${libxslt:prefix}/bin/xslt-config

